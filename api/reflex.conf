# reflex configuration for hot reload

# Watch Go source files (excluding generated code) and OpenAPI yaml
# -R excludes directories/files
-R 'gen/' -R '_test\.go$' -r '\.(go|yaml)$' -s -- sh -c '
if ls /app/resources/openapi/*.yaml 1> /dev/null 2>&1; then
  echo "[Reflex] Generating OpenAPI code..."
  oapi-codegen -package gen -generate types,server,spec /app/resources/openapi/openapi.yaml > /app/gen/openapi.gen.go
  echo "[Reflex] OpenAPI code generated"
fi
echo "[Reflex] Starting application..."
go run /app/cmd/main.go
'
